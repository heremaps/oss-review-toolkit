/*
 * Copyright (C) 2021 Bosch.IO GmbH
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * SPDX-License-Identifier: Apache-2.0
 * License-Filename: LICENSE
 */

package org.ossreviewtoolkit.model

import io.kotest.core.spec.style.StringSpec
import io.kotest.matchers.nulls.beNull
import io.kotest.matchers.should
import io.kotest.matchers.shouldBe

class VulnerabilityTest : StringSpec({
    "The rating should be correct for a given severity" {
        Vulnerability("", -0.1f).rating should beNull()

        Vulnerability("", 0.0f).rating shouldBe Vulnerability.Rating.NONE

        Vulnerability("", 0.1f).rating shouldBe Vulnerability.Rating.LOW
        Vulnerability("", 3.9f).rating shouldBe Vulnerability.Rating.LOW

        Vulnerability("", 4.0f).rating shouldBe Vulnerability.Rating.MEDIUM
        Vulnerability("", 6.9f).rating shouldBe Vulnerability.Rating.MEDIUM

        Vulnerability("", 7.0f).rating shouldBe Vulnerability.Rating.HIGH
        Vulnerability("", 8.9f).rating shouldBe Vulnerability.Rating.HIGH

        Vulnerability("", 9.0f).rating shouldBe Vulnerability.Rating.CRITICAL
        Vulnerability("", 10.0f).rating shouldBe Vulnerability.Rating.CRITICAL

        Vulnerability("", 10.1f).rating should beNull()
    }
})
